<ion-grid class="form-container" *ngIf="debug">
  <ion-row >
    <ion-col size="0" size-md="3" size-lg="3">
      <ion-label class="ion-float-end">Debug :</ion-label>
    </ion-col>
    <ion-col>
      <ion-text color="primary" class="text-italic">
        <small>
          batchTreeContainer.loading: {{loading}}<br/>
          batchTreeContainer.ready: {{readySubject|async}}<br/>
          batchTreeContainer.dirty: {{dirty}}<br/>
          batchTreeContainer.value: {{!!data}}<br/>
        </small>
      </ion-text>
    </ion-col>
  </ion-row>
</ion-grid>
<ion-grid>
  <ion-row>
    <ion-col size="3">
      <ion-list>
        <mat-tree [dataSource]="modelDataSource"
                  [treeControl]="modelTreeControl"
                  class="batch-tree">
          <!-- Nodes children (expandable) -->
          <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild" >
            <ion-item-divider matTreeNodeToggle>
              <ion-label>{{(node.name || node.label)|translate}}</ion-label>
              <ion-icon *ngIf="node.pmfms|arrayFilter: isWeightPmfm|isNotEmptyArray"></ion-icon>
            </ion-item-divider>
            <ng-container matTreeNodeOutlet [class.cdk-visually-hidden]="!modelTreeControl.isExpanded(node)"></ng-container>
          </mat-nested-tree-node>

          <!-- Leaf nodes -->
          <mat-tree-node *matTreeNodeDef="let node" >
            <ion-item (click)="selectDef(node)" matTreeNodeToggle>
              <ion-label>{{(node.name || node.label)|translate}}</ion-label>
              <ion-icon slot="end" name="alert-circle" color="danger" ></ion-icon>
            </ion-item>
          </mat-tree-node>
        </mat-tree>
      </ion-list>
    </ion-col>
    <ion-col>
      <ng-container *ngFor="let def of definitions; when: ifLeaf">
        {{def.label}}
<!--        <app-batches-table #childTree></app-batches-table>-->
<!--        <app-batch-tree #childTree-->
<!--                        [queryTabIndexParamName]="queryTabIndexParamName"-->
<!--                        [showBatchTables]="showBatchTables"-->
<!--                        [allowSamplingBatches]="allowSamplingBatches"-->
<!--                        [allowSubBatches]="allowSubBatches"-->
<!--                        [defaultHasSubBatches]="defaultHasSubBatches"-->
<!--                        [availableTaxonGroups]="availableTaxonGroups"-->
<!--                        [usageMode]="usageMode"-->
<!--                        [useSticky]="mobile"-->
<!--                        [mobile]="mobile"-->
<!--                        [disabled]="disabled"-->
<!--                        [i18nPmfmPrefix]="'TRIP.BATCH.PMFM.'"-->
<!--                        [filter]="def.filter" [debug]="debug">-->
<!--          &lt;!&ndash; [debug]="debug"&ndash;&gt;-->
<!--        </app-batch-tree>-->
      </ng-container>
    </ion-col>
  </ion-row>
<!--  <ion-row>-->
<!--    <ion-col size="3">-->
<!--      <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="batch-tree">-->
<!--        &lt;!&ndash; This is the tree node template for leaf nodes &ndash;&gt;-->
<!--        <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>-->
<!--          <li class="mat-tree-node">-->
<!--            &lt;!&ndash; use a disabled button to provide padding for tree leaf &ndash;&gt;-->
<!--            <button mat-icon-button disabled></button>-->
<!--            {{node.label|translate}}-->
<!--            <ion-icon slot="end" name="alert-circle" color="danger" ></ion-icon>-->
<!--          </li>-->
<!--        </mat-tree-node>-->
<!--        &lt;!&ndash; This is the tree node template for expandable nodes &ndash;&gt;-->
<!--        <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild" matTreeNodeToggle>-->
<!--          <li>-->
<!--            <div class="mat-tree-node">-->
<!--              <button mat-icon-button-->
<!--                      [attr.aria-label]="'toggle ' + node.name">-->
<!--                <mat-icon class="mat-icon-rtl-mirror">-->
<!--                  {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}-->
<!--                </mat-icon>-->
<!--              </button>-->
<!--              {{node.label|translate}}-->
<!--            </div>-->
<!--            <ul [class.batch-tree-invisible]="!treeControl.isExpanded(node)">-->
<!--              <ng-container matTreeNodeOutlet></ng-container>-->
<!--            </ul>-->
<!--          </li>-->
<!--        </mat-nested-tree-node>-->
<!--      </mat-tree>-->
<!--    </ion-col>-->
<!--    <ion-col>-->

<!--    </ion-col>-->
<!--  </ion-row>-->
</ion-grid>
