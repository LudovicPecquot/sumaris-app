<app-toolbar [defaultBackHref]="$defaultBackHref|async" canGoBack="true">

<ion-title [innerHTML]="$title|async"></ion-title>
<ion-buttons slot="end">
  <ion-button (click)="slides.print($event)">
    <ion-icon name="print"></ion-icon>
  </ion-button>
</ion-buttons>
</app-toolbar>

<ion-content>

  <ion-item *ngIf="error && showError" lines="none">
    <ion-icon color="danger" slot="start" name="alert-circle"></ion-icon>
    <ion-label color="danger" class="error" [innerHTML]="error|translate"></ion-label>
  </ion-item>

  <app-slides #slides *ngIf="!error" [options]="slidesOptions">
    <section>
      <ng-container *ngIf="loaded; else loadingTemplate">
        <section>
          <h1>{{ 'TRIP.REPORT.TITLE_SLIDE'|translateContext: i18nContext.suffix }}</h1>
          <ul>
            <li>{{ 'TRIP.TABLE.VESSEL'|translateContext: i18nContext.suffix }} : {{ data.vesselSnapshot.exteriorMarking }}</li>
            <li>{{ 'TRIP.DEPARTURE_DATE_TIME'|translateContext: i18nContext.suffix }} : {{ data.departureDateTime|dateFormat:{time: false} }}</li>
            <li>{{ 'TRIP.DEPARTURE_LOCATION'|translateContext: i18nContext.suffix }} : {{ data.departureLocation.name }}</li>
          </ul>
        </section>
        <section>
          <h2>Représentation, répartition par taille</h2>
          <div style="height:450px">
          <canvas baseChart
                  [datasets]="stats.chart1.data.datasets"
                  [labels]="stats.chart1.data.labels"
                  [chartType]="'bar'">
          </canvas>
          </div>
        </section>
        <section>
          <h2>{{ 'TRIP.OPERATION.MAP.TITLE'|translate }}</h2>
          <div style="height: 550px">
            <app-operations-map #operationsMap
                [modal]="false"
                [programLabel]="data.program.label"
                [data]="[data.operations]"
                [latLongPattern]="settings.latLongFormat">
            </app-operations-map>
          </div>
        </section>
      </ng-container>
    </section>
  </app-slides>

  <ng-template #loadingTemplate>
    <div class="loader">
      <ion-spinner slot="start" color="secondary" size="large"></ion-spinner>
    </div>
  </ng-template>

</ion-content>
